webpackJsonp([1],{"7l2m":function(e,t){},"8eKN":function(e,t,o){e.exports=o.p+"static/img/002.12610fd.png"},"92ym":function(e,t){},"9n10":function(e,t){},"9vsM":function(e,t){},LFOP:function(e,t){},LuYK:function(e,t){},M6Sr:function(e,t){},NHnr:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o("7+uW"),a={render:function(){var e=this.$createElement,t=this._self._c||e;return t("keep-alive",{attrs:{exclude:"Detail"}},[t("router-view")],1)},staticRenderFns:[]};var s=o("VU/8")({name:"App"},a,!1,function(e){o("9vsM")},null,null).exports,r=o("/ocq"),i=o("mtWM"),l=o.n(i);function c(e){return"http://localhost:80/"+e}var h={name:"Login",data:function(){return{userName:"",password:"",errorInfo:""}},methods:{submit:function(){var e=this,t=c("login");""!=this.userName.trim()?""!=this.userName.trim()?(console.log("ok"),console.log(t),l.a.post(t,{userName:this.userName,password:this.password}).then(function(t){0==t.data.code&&(console.log(t.data.token),window.localStorage.setItem("token",t.data.token),e.$router.replace("/phoneBook"))}).catch(function(t){e.errorInfo=t})):this.errorInfo="密码不能为空！":this.errorInfo="用户名不能为空！"}}},m={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("div",{staticClass:"login-logo"},[e._v("通讯录")]),e._v(" "),o("form",{staticClass:"login-cont",attrs:{action:""}},[o("ul",[o("li",[o("input",{directives:[{name:"model",rawName:"v-model",value:e.userName,expression:"userName"}],attrs:{type:"text",placeholder:"请输入用户名"},domProps:{value:e.userName},on:{input:function(t){t.target.composing||(e.userName=t.target.value)}}})]),e._v(" "),o("li",[o("input",{directives:[{name:"model",rawName:"v-model",value:e.password,expression:"password"}],attrs:{type:"password",placeholder:"请输入密码"},domProps:{value:e.password},on:{input:function(t){t.target.composing||(e.password=t.target.value)}}})])]),e._v(" "),o("a",{staticClass:"submitButton",on:{click:e.submit}},[e._v("登  录")]),e._v(" "),o("p",{staticClass:"errorInfo"},[e._v(e._s(e.errorInfo))])]),e._v(" "),e._m(0)])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("p",{staticClass:"copyright"},[this._v("\n    Copyright © 2012-2019 "),t("a",{attrs:{href:"https://i-tiny-leo.github.io/",target:"_blank"}},[this._v("   I-tiny-leo")])])}]};var d=o("VU/8")(h,m,!1,function(e){o("7l2m")},"data-v-61dde32e",null).exports,p={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"header"},[this._v("\n  通讯录\n  "),t("router-link",{staticClass:"iconfont add-icon",attrs:{tag:"div",to:"/add"}},[this._v("")])],1)},staticRenderFns:[]};var u=o("VU/8")({name:"Head"},p,!1,function(e){o("cIuh")},"data-v-bf8e5802",null).exports,v=o("GQaK"),k={name:"Search",data:function(){return{keyword:"",list:[]}},props:{phoneBooks:Object},methods:{getImageUrl:function(e){return c("image/"+e)}},watch:{keyword:function(){var e=this;if(this.keyword){var t=[];for(var o in this.phoneBooks)this.phoneBooks[o].forEach(function(o){o.name.indexOf(e.keyword)>-1&&t.push(o)});this.list=t}else this.list=[]}},mounted:function(){this.scroll=new v.a(this.$refs.search)}},g={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("div",{staticClass:"search"},[o("input",{directives:[{name:"model",rawName:"v-model",value:e.keyword,expression:"keyword"}],staticClass:"search-input",attrs:{type:"text",placeholder:"搜索"},domProps:{value:e.keyword},on:{input:function(t){t.target.composing||(e.keyword=t.target.value)}}})]),e._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:e.keyword,expression:"keyword"}],ref:"search",staticClass:"search-content"},[o("div",[e._l(e.list,function(t){return o("div",{key:t.id,staticClass:"item"},[o("img",{attrs:{src:e.getImageUrl(t.image),alt:"image"}}),e._v(" "),o("div",{staticClass:"content border-bottom"},[e._v(e._s(t.name))])])}),e._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:!e.list.length,expression:"!list.length"}],staticClass:"item center"},[e._v("\n        没有找到匹配数据\n      ")])],2)])])},staticRenderFns:[]};var f=o("VU/8")(k,g,!1,function(e){o("PJOR")},"data-v-474af5e3",null).exports,B={name:"List",props:{phoneBooks:Object,letter:String},methods:{getImageUrl:function(e){return c("image/"+e)}},mounted:function(){this.scroll=new v.a(this.$refs.wrapper,{click:!0})},watch:{letter:function(){if(this.letter){var e=this.$refs[this.letter][0];this.scroll.scrollToElement(e)}}}},_={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{ref:"wrapper",staticClass:"list"},[o("div",e._l(e.phoneBooks,function(t,n){return o("div",{key:n,ref:n,refInFor:!0,staticClass:"phoneBook"},[o("div",{staticClass:"title"},[e._v(e._s(n))]),e._v(" "),e._l(t,function(t){return o("router-link",{key:t.id,staticClass:"item",attrs:{tag:"div",to:"/detail/"+t.id}},[o("img",{attrs:{src:e.getImageUrl(t.image),alt:"image"}}),e._v(" "),o("div",{staticClass:"content border-bottom"},[e._v(e._s(t.name))])])})],2)}),0),e._v(" "),e._m(0)])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"phoneBook"},[t("div",{staticClass:"title"},[this._v("B")]),this._v(" "),t("div",{staticClass:"item"},[t("img",{attrs:{src:o("8eKN")}}),this._v(" "),t("div",{staticClass:"content border-bottom"},[this._v("Bibi")])]),this._v(" "),t("div",{staticClass:"item"},[t("img",{attrs:{src:o("OgY8")}}),this._v(" "),t("div",{staticClass:"content border-bottom"},[this._v("B哥")])])])}]};var w=o("VU/8")(B,_,!1,function(e){o("sVKL")},"data-v-7857d684",null).exports,b={name:"Alphabet",data:function(){return{touchStatus:!1,startY:0,timer:""}},props:{phoneBooks:Object},computed:{letters:function(){var e=[];for(var t in this.phoneBooks)e.push(t);return e}},methods:{handleLetterClick:function(e){console.log(e.target.innerText),this.$emit("change",e.target.innerText)},handleTouchStart:function(){this.touchStatus=!0,console.log("start")},handleTouchMove:function(e){var t=this;console.log("move"),this.timer&&clearTimeout(this.timer),this.timer=setTimeout(function(){if(t.touchStatus){var o=e.touches[0].clientY-79;console.log("startY:"+t.startY);var n=Math.floor((o-t.startY)/20);n>=0&&n<t.letters.length&&t.$emit("change",t.letters[n])}},14)},handleTouchEnd:function(){this.touchStatus=!1,console.log("end")}},updated:function(){this.startY=this.$refs.A[0].offsetTop}},C={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("ul",{staticClass:"list"},e._l(e.letters,function(t,n){return o("li",{key:t,ref:t,refInFor:!0,staticClass:"item",on:{click:e.handleLetterClick,touchstart:e.handleTouchStart,touchmove:e.handleTouchMove,touchend:e.handleTouchEnd}},[e._v(e._s(t))])}),0)},staticRenderFns:[]};var y=o("VU/8")(b,C,!1,function(e){o("92ym")},"data-v-5eec2d01",null).exports,N=o("x9pK"),I=o.n(N),x={name:"PhoneBook",data:function(){return{phoneBooks:{},letter:""}},components:{PhoneBookHeader:u,PhoneBookSearch:f,PhoneBookList:w,PhoneBookAlphabet:y},methods:{refreshToken:function(){var e=window.localStorage.getItem("token");l.a.defaults.headers.common.token=e;var t=c("refreshToken");l.a.get(t).then(function(e){console.log("token刷新："+e.data.token),window.localStorage.setItem("token",e.data.token)}).catch(function(e){console.log(e)})},getPhoneBooks:function(){var e=this,t=window.localStorage.getItem("token");l.a.defaults.headers.common.token=t;var o=c("phoneBook/loadAll");l.a.get(o).then(function(t){console.log(t),e.phoneBooks=t.data.data}).catch(function(e){console.log(e)})},handleLetterChange:function(e){console.log("list组件传来的值为："+e),this.letter=e}},mounted:function(){var e=this;setInterval(this.refreshToken,6e5),this.getPhoneBooks(),I.a.subscribe("refreshPhoneBook",function(t,o){console.log("收到消息 refreshPhoneBook"),e.getPhoneBooks()})}},$={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("phone-book-header"),e._v(" "),o("phone-book-search",{attrs:{phoneBooks:e.phoneBooks}}),e._v(" "),o("phone-book-list",{attrs:{letter:e.letter,phoneBooks:e.phoneBooks}}),e._v(" "),o("phone-book-alphabet",{attrs:{phoneBooks:e.phoneBooks},on:{change:e.handleLetterChange}})],1)},staticRenderFns:[]};var P=o("VU/8")(x,$,!1,function(e){o("f03H")},"data-v-db551c9a",null).exports,A=o("bOdI"),G=o.n(A),S={name:"Gallery",props:{galleryImag:String},methods:{handleClick:function(){this.$emit("hideGlleryClick")}}},T={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"container",on:{click:this.handleClick}},[t("div",{staticClass:"wrapper"},[t("img",{attrs:{src:this.galleryImag}})])])},staticRenderFns:[]};var U=o("VU/8")(S,T,!1,function(e){o("LFOP")},"data-v-55d0fd86",null).exports,E={name:"Add",data:function(){return{phoneBook:{image:"010.png"},showGallery:!1,galleryImag:""}},components:{Gallery:U},methods:{getImageUrl:function(e){return c("image/"+e)},imageClick:function(){this.$refs.file.click()},showGalleryClick:function(){this.galleryImag=this.getImageUrl(this.phoneBook.image),this.showGallery=!0},hideGlleryClick:function(){this.showGallery=!1},addInfo:function(){var e=this,t=c("phoneBook/save"),o=window.localStorage.getItem("token");l.a.defaults.headers.common.token=o,null!=this.phoneBook.name&&""!=this.phoneBook.name.trim()?null!=this.phoneBook.phoneNumber&&""!=this.phoneBook.phoneNumber.trim()?/^1[3456789]\d{9}$/.test(this.phoneBook.phoneNumber)?l.a.post(t,G()({name:this.phoneBook.name,phoneNumber:this.phoneBook.phoneNumber,teleNumber:this.phoneBook.teleNumber,workAddress:this.phoneBook.workAddress,homeAddress:this.phoneBook.homeAddress,image:this.phoneBook.image,remark:this.phoneBook.remark},"image",this.phoneBook.image)).then(function(t){0==t.data.code?(alert("添加成功"),I.a.publish("refreshPhoneBook",""),e.$router.replace("/phoneBook")):alert(t.data.msg)}).catch(function(e){alert(e)}):alert("手机号码有误，请重填"):alert("手机号码不为空！"):alert("姓名不能为空！")},upload:function(e){var t=this,o=e.target.files[0],n=new FormData;n.append("file",o,o.name);var a=window.localStorage.getItem("token"),s=c("uploadImage"),r={header:{"Content-Type":"multipart/form-data",token:a}};l.a.post(s,n,r).then(function(e){0==e.data.code&&(t.phoneBook.image=e.data.data.title)}).catch(function(e){t.errorInfo=e})}}},F={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"detail"},[o("div",{staticClass:"header"},[o("router-link",{staticClass:"iconfont back-icon",attrs:{tag:"div",to:"/phoneBook"}},[e._v("")])],1),e._v(" "),o("div",{staticClass:"image"},[o("div",{staticClass:"info"},[o("img",{attrs:{src:e.getImageUrl(e.phoneBook.image),alt:"头像"},on:{click:e.showGalleryClick}})]),e._v(" "),o("div",{staticClass:"action"},[o("button",{on:{click:e.imageClick}},[e._v("修改头像")]),e._v(" "),o("input",{ref:"file",attrs:{type:"file",name:"file",accept:"image/png,image/gif,image/jpeg,image/jpg"},on:{change:e.upload}})])]),e._v(" "),o("div",{staticClass:"userInfo"},[o("div",{staticClass:"item border-bottom"},[o("span",[e._v("姓名")]),e._v(" "),o("input",{directives:[{name:"model",rawName:"v-model",value:e.phoneBook.name,expression:"phoneBook.name"}],attrs:{type:"text"},domProps:{value:e.phoneBook.name},on:{input:function(t){t.target.composing||e.$set(e.phoneBook,"name",t.target.value)}}})]),e._v(" "),o("div",{staticClass:"item border-bottom"},[o("span",[e._v("手机号码")]),e._v(" "),o("input",{directives:[{name:"model",rawName:"v-model",value:e.phoneBook.phoneNumber,expression:"phoneBook.phoneNumber"}],attrs:{type:"text"},domProps:{value:e.phoneBook.phoneNumber},on:{input:function(t){t.target.composing||e.$set(e.phoneBook,"phoneNumber",t.target.value)}}})]),e._v(" "),o("div",{staticClass:"item border-bottom"},[o("span",[e._v("座机电话号码")]),e._v(" "),o("input",{directives:[{name:"model",rawName:"v-model",value:e.phoneBook.teleNumber,expression:"phoneBook.teleNumber"}],attrs:{type:"text"},domProps:{value:e.phoneBook.teleNumber},on:{input:function(t){t.target.composing||e.$set(e.phoneBook,"teleNumber",t.target.value)}}})]),e._v(" "),o("div",{staticClass:"item border-bottom"},[o("span",[e._v("工作单位地址")]),e._v(" "),o("textarea",{directives:[{name:"model",rawName:"v-model",value:e.phoneBook.workAddress,expression:"phoneBook.workAddress"}],domProps:{value:e.phoneBook.workAddress},on:{input:function(t){t.target.composing||e.$set(e.phoneBook,"workAddress",t.target.value)}}})]),e._v(" "),o("div",{staticClass:"item border-bottom"},[o("span",[e._v("家庭地址")]),e._v(" "),o("textarea",{directives:[{name:"model",rawName:"v-model",value:e.phoneBook.homeAddress,expression:"phoneBook.homeAddress"}],domProps:{value:e.phoneBook.homeAddress},on:{input:function(t){t.target.composing||e.$set(e.phoneBook,"homeAddress",t.target.value)}}})]),e._v(" "),o("div",{staticClass:"item border-bottom"},[o("span",[e._v("备注")]),e._v(" "),o("textarea",{directives:[{name:"model",rawName:"v-model",value:e.phoneBook.remark,expression:"phoneBook.remark"}],domProps:{value:e.phoneBook.remark},on:{input:function(t){t.target.composing||e.$set(e.phoneBook,"remark",t.target.value)}}})])]),e._v(" "),o("div",{staticClass:"action"},[o("div",{staticClass:"item border-bottom"},[o("a",{on:{click:e.addInfo}},[e._v("保存")])])]),e._v(" "),o("gallery",{directives:[{name:"show",rawName:"v-show",value:e.showGallery,expression:"showGallery"}],attrs:{galleryImag:e.galleryImag},on:{hideGlleryClick:e.hideGlleryClick}})],1)},staticRenderFns:[]};var L=o("VU/8")(E,F,!1,function(e){o("LuYK")},"data-v-638b3a78",null).exports,O={name:"Detail",data:function(){return{phoneBook:{image:"010.png"},showGallery:!1,galleryImag:""}},components:{Gallery:U},methods:{getImageUrl:function(e){return c("image/"+e)},imageClick:function(){this.$refs.file.click()},showGalleryClick:function(){this.galleryImag=this.getImageUrl(this.phoneBook.image),this.showGallery=!0},hideGlleryClick:function(){this.showGallery=!1},deleteInfo:function(){var e=this;if(confirm("确定要删除这条记录吗？")){var t=c("phoneBook/delete"),o=window.localStorage.getItem("token");l.a.defaults.headers.common.token=o,l.a.get(t,{params:{id:this.$route.params.id}}).then(function(t){0==t.data.code?(alert("删除成功！"),I.a.publish("refreshPhoneBook",""),e.$router.replace("/phoneBook")):alert(t.data.msg)}).catch(function(e){alert(e)})}},updateInfo:function(){var e=this,t=c("phoneBook/save"),o=window.localStorage.getItem("token");l.a.defaults.headers.common.token=o,null!=this.phoneBook.name&&""!=this.phoneBook.name.trim()?null!=this.phoneBook.phoneNumber&&""!=this.phoneBook.phoneNumber.trim()?/^1[3456789]\d{9}$/.test(this.phoneBook.phoneNumber)?l.a.post(t,G()({id:this.phoneBook.id,name:this.phoneBook.name,phoneNumber:this.phoneBook.phoneNumber,teleNumber:this.phoneBook.teleNumber,workAddress:this.phoneBook.workAddress,homeAddress:this.phoneBook.homeAddress,image:this.phoneBook.image,remark:this.phoneBook.remark},"image",this.phoneBook.image)).then(function(t){0==t.data.code?(alert("修改成功"),I.a.publish("refreshPhoneBook",""),e.$router.replace("/phoneBook")):alert(t.data.msg)}).catch(function(e){alert(e)}):alert("手机号码有误，请重填"):alert("手机号码不为空！"):alert("姓名不能为空！")},upload:function(e){var t=this,o=e.target.files[0],n=new FormData;n.append("file",o,o.name);var a=window.localStorage.getItem("token"),s=c("uploadImage"),r={header:{"Content-Type":"multipart/form-data",token:a}};l.a.post(s,n,r).then(function(e){0==e.data.code&&(t.phoneBook.image=e.data.data.title)}).catch(function(e){t.errorInfo=e})},getInfo:function(){var e=this,t=c("phoneBook/findById"),o=window.localStorage.getItem("token");l.a.defaults.headers.common.token=o,l.a.get(t,{params:{id:this.$route.params.id}}).then(function(t){e.phoneBook=t.data.phoneBook}).catch(function(e){alert(e)})}},mounted:function(){console.log(this.$route),this.getInfo()}},R={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"detail"},[o("div",{staticClass:"header"},[o("router-link",{staticClass:"iconfont back-icon",attrs:{tag:"div",to:"/phoneBook"}},[e._v("")])],1),e._v(" "),o("div",{staticClass:"image"},[o("div",{staticClass:"info"},[o("img",{attrs:{src:e.getImageUrl(e.phoneBook.image),alt:"头像"},on:{click:e.showGalleryClick}})]),e._v(" "),o("div",{staticClass:"action"},[o("button",{on:{click:e.imageClick}},[e._v("修改头像")]),e._v(" "),o("input",{ref:"file",attrs:{type:"file",name:"file",accept:"image/png,image/gif,image/jpeg,image/jpg"},on:{change:e.upload}})])]),e._v(" "),o("div",{staticClass:"userInfo"},[o("div",{staticClass:"item border-bottom"},[o("span",[e._v("姓名")]),e._v(" "),o("input",{directives:[{name:"model",rawName:"v-model",value:e.phoneBook.name,expression:"phoneBook.name"}],attrs:{type:"text"},domProps:{value:e.phoneBook.name},on:{input:function(t){t.target.composing||e.$set(e.phoneBook,"name",t.target.value)}}})]),e._v(" "),o("div",{staticClass:"item border-bottom"},[o("span",[e._v("手机号码")]),e._v(" "),o("input",{directives:[{name:"model",rawName:"v-model",value:e.phoneBook.phoneNumber,expression:"phoneBook.phoneNumber"}],attrs:{type:"text"},domProps:{value:e.phoneBook.phoneNumber},on:{input:function(t){t.target.composing||e.$set(e.phoneBook,"phoneNumber",t.target.value)}}})]),e._v(" "),o("div",{staticClass:"item border-bottom"},[o("span",[e._v("座机电话号码")]),e._v(" "),o("input",{directives:[{name:"model",rawName:"v-model",value:e.phoneBook.teleNumber,expression:"phoneBook.teleNumber"}],attrs:{type:"text"},domProps:{value:e.phoneBook.teleNumber},on:{input:function(t){t.target.composing||e.$set(e.phoneBook,"teleNumber",t.target.value)}}})]),e._v(" "),o("div",{staticClass:"item border-bottom"},[o("span",[e._v("工作单位地址")]),e._v(" "),o("textarea",{directives:[{name:"model",rawName:"v-model",value:e.phoneBook.workAddress,expression:"phoneBook.workAddress"}],domProps:{value:e.phoneBook.workAddress},on:{input:function(t){t.target.composing||e.$set(e.phoneBook,"workAddress",t.target.value)}}})]),e._v(" "),o("div",{staticClass:"item border-bottom"},[o("span",[e._v("家庭地址")]),e._v(" "),o("textarea",{directives:[{name:"model",rawName:"v-model",value:e.phoneBook.homeAddress,expression:"phoneBook.homeAddress"}],domProps:{value:e.phoneBook.homeAddress},on:{input:function(t){t.target.composing||e.$set(e.phoneBook,"homeAddress",t.target.value)}}})]),e._v(" "),o("div",{staticClass:"item border-bottom"},[o("span",[e._v("备注")]),e._v(" "),o("textarea",{directives:[{name:"model",rawName:"v-model",value:e.phoneBook.remark,expression:"phoneBook.remark"}],domProps:{value:e.phoneBook.remark},on:{input:function(t){t.target.composing||e.$set(e.phoneBook,"remark",t.target.value)}}})])]),e._v(" "),o("div",{staticClass:"action"},[o("div",{staticClass:"item border-bottom"},[o("a",{on:{click:e.updateInfo}},[e._v("保存修改")])]),e._v(" "),o("div",{staticClass:"item border-bottom"},[o("a",{on:{click:e.deleteInfo}},[e._v("删除")])])]),e._v(" "),o("gallery",{directives:[{name:"show",rawName:"v-show",value:e.showGallery,expression:"showGallery"}],attrs:{galleryImag:e.galleryImag},on:{hideGlleryClick:e.hideGlleryClick}})],1)},staticRenderFns:[]};var V=o("VU/8")(O,R,!1,function(e){o("tc4c")},"data-v-c0a9a612",null).exports;n.a.use(r.a);var Y=new r.a({routes:[{path:"/",name:"Login",component:d},{path:"/phoneBook",name:"PhoneBook",component:P},{path:"/add",name:"Add",component:L},{path:"/detail/:id",name:"Detail",component:V}]});o("9n10"),o("M6Sr"),o("TzC8");n.a.config.productionTip=!1,new n.a({el:"#app",router:Y,components:{App:s},template:"<App/>"})},OgY8:function(e,t,o){e.exports=o.p+"static/img/003.7ef7409.png"},PJOR:function(e,t){},TzC8:function(e,t){},cIuh:function(e,t){},f03H:function(e,t){},sVKL:function(e,t){},tc4c:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.e2bfceff7606cdb9f6b0.js.map